<ui:composition template="/templates/mainTemplate.xhtml" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="title"> Klient - Analiza wyciągów bankowych </ui:define> 
    <ui:define name="content">
        
        
        
        <h3> Analiza wyciągów bankowych </h3> 
        
        <h:form id="form1">
               <p:messages showDetail="true"/>   
        </h:form>     

        <h4> Załaduj nowy plik .csv:  </h4>

        <h:form enctype="multipart/form-data">
  

            <p:fileUpload style="width: 250px; float: left"  styleClass="greyButton" id="idCardUpload" value="#{csvMB.csvFile}" mode="simple" > 

            </p:fileUpload>

            <p:selectOneMenu style="margin: 5px 0px 0px 20px; float: left;" value="#{csvMB.selectedBank}"  >
                <f:selectItem itemLabel="Wybierz..." itemValue="-1" />
                <f:selectItem itemLabel="PKO Bank Polski" itemValue="1" />  
                <f:selectItem itemLabel="BZ WBK" itemValue="2" />  
            </p:selectOneMenu>


            <p:commandLink ajax="false" id="przycisk1" styleClass="greenButton wideButton floatL" style="margin: 5px 20px 20px 20px;"  value="Wczytaj pliki" type="submit" action="#{csvMB.upload()}" />      

        </h:form>    

        <div style="clear: both;" >
            <h4> Wyciąg:  </h4>
        </div>

        <div style="min-height: 50px; margin-top: 50px">
            <h:form>

                <p:dataTable id="csvTable" value="#{csvMB.history}" var="row" rowIndexVar="rowIndex" rowKey="#{row}" emptyMessage="Brak rekordów wgraj plik z wyciągiem konta." selectionMode="single" 
                             editable="true" editMode="cell">

                    <p:column headerText="Nr.">  
                        <h:outputText  value="#{rowIndex+1}"/>
                    </p:column>  

                    <p:column headerText="Data"> 
                        <h:outputText value="#{row.operationDate}" />
                    </p:column>                 

                    <p:column headerText="Tytuł">  
                        <h:outputText  value="#{row.title}"/>
                    </p:column> 
                    
                    <p:column headerText="Nadawca/Odiorca"> 
                        <h:outputText  value="#{row.receiver}"/>
                    </p:column>

                    <p:column headerText="Kwota"> 
                        <h:outputText  value="#{row.amount}"/>
                    </p:column>
                    


                    <p:column headerText="Saldo po"> 
                        <h:outputText  value="#{row.afterOperation}"/>        
                    </p:column> 

                    <p:column headerText="Typ">  
                                <p:selectOneMenu value="#{row.operationType}" style="width: 200px">  
                                    <f:selectItems value="#{csvMB.operationTypes}" />
                                </p:selectOneMenu>  
                    </p:column>    

                </p:dataTable>
                <h:commandButton action="#{csvMB.save()}" class="greenButton wideButton floatR" value="Zapisz"/>
            </h:form> 
        </div>


    </ui:define>

</ui:composition>
