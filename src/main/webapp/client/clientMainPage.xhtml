<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

    <body>

        <ui:composition template="/templates/mainTemplate.xhtml">
            <ui:define name="title"> Klient - ekran główny </ui:define> 
            <ui:define name="top"> 
                <h:outputStylesheet library="css" name="green.css" />
                <h:form>

                    <f:event type="preRenderView" listener="#{clientMainPageMB.reload()}" />
                    <p:poll interval="40" listener="#{clientMainPageMB.fillTables()}" update=":lastForm :awaitingForm :currentForm :premiumForm :finishedForm" /> 
               
                <div class="topbarLogo">
                    <h:graphicImage id="sf_logo" alt="could not be found."  value="/resources/images/spolecznosc_logo2.png" title="SF Logo" ></h:graphicImage>
                    <h:link outcome="/client/clientMainPage"> <h:graphicImage class="bigMenuButton" id="green_home_icon" alt="could not be found."  value="/resources/images/home_green.png" title="Home" ></h:graphicImage> </h:link>
                    <h:link outcome="/client/clientSettings"> <h:graphicImage class="bigMenuButton" id="profile_icon" alt="could not be found."  value="/resources/images/profile_logo_black.png" title="Profile" ></h:graphicImage> </h:link>
                </div>
                </h:form>

                <h:form>
                    
                    <div class="topbarMenuGreen">

                        <h:panelGroup>


                            <h:commandLink class="topMenuButton greyButton wideButton" value="Wyloguj" action="#{loginMB.logout()}"/>
                            <h:link class="topMenuButton greyButton wideButton" value="Najlepsi doaradcy" outcome="/common/scoreBoard"/>
                            <h:link class="topMenuButton greyButton wideButton" value="Wiadomości" outcome="/client/clientViewMessages"/>
                            <h:link class="topMenuButton greyButton wideButton" value="Usuń konto" outcome="/client/clientDeleteAccount"/>
                            <p:commandLink styleClass="topMenuButton greyButton wideButton" value="Doładuj konto" update=":dialog1" oncomplete="dodaj.show()" />
                            <h:link class="topMenuButton greyButton wideButton" value="Zgłoś naruszenie zasad" outcome="/policy_violation"/>

                        </h:panelGroup>

                    </div>

                </h:form>

                <p:dialog id="dialog1" header="Dodaj punkty" widgetVar="dodaj" modal="true"  resizable="false" showEffect="fade" hideEffect="fade" >  

                    <h:form id="form">

                        <div > 
                            <p:selectOneButton value="#{clientMainPageMB.newPoints}" required="true">  
                                <f:selectItem itemLabel="5 Punktów" itemValue="5" />  
                                <f:selectItem itemLabel="30 Punktów" itemValue="30" />  
                                <f:selectItem itemLabel="100 Punktów" itemValue="100" />  
                            </p:selectOneButton>  
                        </div>      

                        <div style=" margin-top: 20px;">
                            <p:commandButton style="margin-top: 10px; float: left;" value="Anuluj" type="button" onclick="dodaj.hide()" />
                            <p:commandButton style="margin-top: 10px; float: right;" ajax="true" update=":test"  value="Dodaj" type="submit" oncomplete="if (!args.validationFailed) dodaj.hide()" action="#{clientMainPageMB.addPoints()}" />     
                        </div>

                    </h:form>

                </p:dialog>   

            </ui:define>

            <ui:define name="content">

                <script>
                    $(document).ready(function(){
                        $("#hide").click(function(){
                            $("#all").toggle();
                            $("#last").toggle();
                        });
                    });
                    
                    $(document).ready(function(){
                        $("#show").click(function(){
                            $("#all").toggle();
                            $("#last").toggle();    
                        });
                    });
                    
                </script>

                <h:panelGroup rendered="#{!(empty messagesMB.unreadMessagesList) }" >
                    <h:form> 
                        <div style="min-height: 80px; border-bottom: green 4px solid">
                            <h:graphicImage id="red_envelope" class="floatL" style="margin-left: 10px; margin-top:10px" alt="could not be found."  value="/resources/images/mail_red.png" title="RedEnvelope" ></h:graphicImage>
                            <h:outputText class="redMessage floatL marginLRT30" value="Uwaga! Masz nieprzeczytane wiadomości. Ilość:  #{messagesMB.unreadMessagesList.size()}" /> 
                                
                            <h:commandButton  class="floatR greyButton wideButton marginT50" value="Obczaj" action="#{messagesMB.toViewMessages()}" />  
                        </div>
                    </h:form>
                </h:panelGroup>
                

                <div class="marginT50"> 
                    <h:form>
                        <p:commandButton styleClass="topMenuButton greyButton wideButton" value="Nowy wniosek" action="#{clientMainPageMB.redirectNewApplication()}" oncomplete="if (#{!clientMainPageMB.requirementsFulfilled}) {fillData.show();}" />

                        <p:dialog id="informDialog" header="Uzupełnij dane" widgetVar="fillData" modal="true"  resizable="false" showEffect="fade" hideEffect="fade" >  

                            <div class="fontGrey"> Do utworzenia nowego wniosku potrzebne są następujące informacje: <br /><br />
                                  Data urodzenia <br /> PESEL   <br /> Informacje o dochodach <br /> Województwo <br /> Kod pocztowy <br /> <br /> Czy chcesz uzupełnić swoje dane teraz?                                                              
                            </div>
                            <h:commandButton class="marginTB20 floatL greyButton wideButton"  type="button" onclick="fillData.hide();" value="Nie" />
                            <h:link class="marginTB20 floatR greyButton wideButton linkWidth" value="Tak" outcome="clientSettings?faces-redirect=true" />
                        </p:dialog> 
                    </h:form>
                    
                    <h4> OSTATNIA AKTYWNOŚĆ NA GIEŁDZIE </h4>

                    <div id="last">
                        <h:form id="lastForm">
                            <p:dataTable id="lastCases" value="#{clientMainPageMB.clientCaseList}" var="row" rowKey="#{row}" emptyMessage="Nie ma żadnych spraw" selection="#{clientMainPageMB.lastSelectedCase}" selectionMode="single" >

                                <p:ajax event="rowSelect" update="@form"/> 
                                <p:ajax event="rowDblselect"  listener="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.lastSelectedCase)}"/>

                                <p:column headerText="Data dodania">    
                                    <h:outputText  value="#{row.beginDate}">
                                        <f:convertDateTime pattern="dd-MM-yy" timeZone="GMT+3"/>
                                    </h:outputText>  
                                </p:column>  

                                <p:column headerText="Numer sprawy">  
                                    <h:outputText  value="#{row.idClientCase}"/>
                                </p:column>  

                                <p:column headerText="Postęp">  
                                    <h:outputText  value="#{row.phase}"/>
                                </p:column> 

                                <p:column headerText="Rodzaj kredytu"  >
                                    <h:outputText  value="#{row.productType.name}"/>
                                </p:column> 

                                <p:column headerText="BIK">
                                    <h:outputText  value="#{clientMainPageMB.showBIK(row.client) ? 'TAK' : 'NIE' }"/>                         
                                </p:column> 

                                <p:column headerText="Kod pocztowy">  
                                    <h:outputText  value="#{row.client.addresses.toArray()[0].zipCode}"/>
                                </p:column>

                                <p:column headerText="Wiek">  
                                    <h:outputText  value="#{clientMainPageMB.converters.ageFromBirthDate(row.client.birthDate)}"/>
                                </p:column>

                                <p:column headerText="Typ zatrudnienia">
                                    <h:outputText rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() == 1}" value="#{clientMainPageMB.modelsEmploymentType.get(0).toArray()[0]}"/>
                                    <h:selectOneMenu rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() > 1}" value=" ">
                                        <f:selectItems value="#{clientMainPageMB.modelsEmploymentType.get(0)}" />
                                    </h:selectOneMenu>
                                </p:column>

                                <p:column headerText="Branża"> 
                                    <h:outputText rendered="#{clientMainPageMB.modelsBranch.get(0).size() == 1}" value="#{clientMainPageMB.modelsBranch.get(0).toArray()[0]}"/>
                                    <h:selectOneMenu rendered="#{clientMainPageMB.modelsBranch.get(0).size() > 1}" value=" ">
                                        <f:selectItems value="#{clientMainPageMB.modelsBranch.get(0)}" />
                                    </h:selectOneMenu>
                                </p:column>

                                <p:column headerText="Trudność kredytu"> 
                                    <h:outputText  value="#{row.difficulty}"/>
                                </p:column>

                                <p:column headerText="Ilość doradców"> 
                                    <h:outputText value="#{clientMainPageMB.countConsultantApplications(row)}" />
                                </p:column>

                                <p:column headerText="Koniec aukcji"> 
                                    <h:outputText  value="#{clientMainPageMB.converters.hoursLeft(row.endDate)}"/>        
                                </p:column> 


                            </p:dataTable>
                            <button class="topMenuButton greyButton wideButton" type="reset" id="hide">Pokaż wszystkie</button>
                            <p:commandButton disabled="#{empty clientMainPageMB.lastSelectedCase}" ajax="false" styleClass="topMenuButton greyButton wideButton" value="Szczegóły" action="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.lastSelectedCase)}" />
                   
                        </h:form>
                    </div>

                    <div id="all" style="display: none;">

                        <h:form id="allForm">

                            <p:dataTable id="allCases" value="#{clientMainPageMB.allClientCaseList}"  var="row" rowKey="#{row}" emptyMessage="Nie ma żadnych spraw" selection="#{clientMainPageMB.lastSelectedCase}" selectionMode="single" >

                                <p:ajax event="rowSelect" update="@form"/> 
                                <p:ajax event="rowDblselect"  listener="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.lastSelectedCase)}"/>

                                <p:column headerText="Data dodania">    
                                    <h:outputText  value="#{row.beginDate}">
                                        <f:convertDateTime pattern="dd-MM-yy" timeZone="GMT+3"/>
                                    </h:outputText>  
                                </p:column>  

                                <p:column headerText="Numer sprawy">  
                                    <h:outputText  value="#{row.idClientCase}"/>
                                </p:column>  

                                <p:column headerText="Postęp">  
                                    <h:outputText  value="#{row.phase}"/>
                                </p:column> 

                                <p:column headerText="Rodzaj kredytu"  >
                                    <h:outputText  value="#{row.productType.name}"/>
                                </p:column> 

                                <p:column headerText="BIK">
                                    <h:outputText  value="#{clientMainPageMB.showBIK(row.client) ? 'TAK' : 'NIE' }"/>                         
                                </p:column> 

                                <p:column headerText="Kod pocztowy">  
                                    <h:outputText  value="#{row.client.addresses.toArray()[0].zipCode}"/>
                                </p:column>

                                <p:column headerText="Wiek">  
                                    <h:outputText  value="#{clientMainPageMB.converters.ageFromBirthDate(row.client.birthDate)}"/>
                                </p:column>

                                <p:column headerText="Typ zatrudnienia">
                                    <h:outputText rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() == 1}" value="#{clientMainPageMB.modelsEmploymentType.get(0).toArray()[0]}"/>
                                    <h:selectOneMenu rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() > 1}" value=" ">
                                        <f:selectItems value="#{clientMainPageMB.modelsEmploymentType.get(0)}" />
                                    </h:selectOneMenu>
                                </p:column>

                                <p:column headerText="Branża"> 
                                    <h:outputText rendered="#{clientMainPageMB.modelsBranch.get(0).size() == 1}" value="#{clientMainPageMB.modelsBranch.get(0).toArray()[0]}"/>
                                    <h:selectOneMenu rendered="#{clientMainPageMB.modelsBranch.get(0).size() > 1}" value=" ">
                                        <f:selectItems value="#{clientMainPageMB.modelsBranch.get(0)}" />
                                    </h:selectOneMenu>
                                </p:column>

                                <p:column headerText="Trudność kredytu"> 
                                    <h:outputText  value="#{row.difficulty}"/>
                                </p:column>

                                <p:column headerText="Ilość doradców"> 
                                    <h:outputText value="#{clientMainPageMB.countConsultantApplications(row)}" />
                                </p:column>

                                <p:column headerText="Koniec aukcji"> 
                                    <h:outputText  value="#{clientMainPageMB.converters.hoursLeft(row.endDate)}"/>        
                                </p:column> 

                                <!--                        <p:column headerText=""> 
                                                                <h:outputText  value=" "/>
                                                            </p:column> -->



                            </p:dataTable>
                            <button class="topMenuButton greyButton wideButton" type="reset" id="show">Pokaż tylko ostatnie</button>
                            <p:commandButton disabled="#{empty clientMainPageMB.lastSelectedCase}" ajax="false" styleClass="topMenuButton greyButton wideButton" value="Szczegóły" action="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.lastSelectedCase)}" />
                        </h:form>
                    </div>    

                </div>



                <div  class="marginT50">

                    <h4>OCZEKUJĄCE</h4>

                    <h:form id="awaitingForm">

                        <p:dataTable id="awaitingCases" value="#{clientMainPageMB.awaitingClientCaseList}" rowKey="#{row.idClientCase}"  var="row" emptyMessage="Nie ma żadnych spraw" selection="#{clientMainPageMB.awaitingSelectedCase}" selectionMode="single" >

                            <p:ajax event="rowSelect"  update="@form" /> 
                            <p:ajax event="rowDblselect"  listener="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.awaitingSelectedCase)}"/>

                            <p:column headerText="Data dodania">    
                                <h:outputText  value="#{row.beginDate}">
                                    <f:convertDateTime pattern="dd-MM-yy" timeZone="GMT+3"/>
                                </h:outputText>  
                            </p:column>  

                            <p:column headerText="Numer sprawy">  
                                <h:outputText  value="#{row.idClientCase}"/>
                            </p:column> 

                            <p:column headerText="Postęp">  
                                <h:outputText  value="#{row.phase}"/>
                            </p:column> 

                            <p:column headerText="Rodzaj kredytu">
                                <h:outputText  value="#{row.productType.name}"/>
                            </p:column> 

                            <p:column headerText="BIK">
                                <h:outputText  value="#{clientMainPageMB.showBIK(row.client) ? 'TAK' : 'NIE' }"/>                         
                            </p:column> 

                            <p:column headerText="Kod pocztowy">  
                                <h:outputText  value="#{row.client.addresses.toArray()[0].zipCode}"/>
                            </p:column>

                            <p:column headerText="Wiek">  
                                <h:outputText  value="#{clientMainPageMB.converters.ageFromBirthDate(row.client.birthDate)}"/>
                            </p:column>

                            <p:column headerText="Typ zatrudnienia">
                                <h:outputText rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() == 1}" value="#{clientMainPageMB.modelsEmploymentType.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsEmploymentType.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Branża"> 
                                <h:outputText rendered="#{clientMainPageMB.modelsBranch.get(0).size() == 1}" value="#{clientMainPageMB.modelsBranch.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsBranch.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsBranch.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Trudność kredytu"> 
                                <h:outputText  value="#{row.difficulty}"/>
                            </p:column>

                            <p:column headerText="Ilość doradców"> 
                                <h:outputText value="#{clientMainPageMB.countConsultantApplications(row)}" />
                            </p:column>

                            <p:column headerText="Ilość wyświetleń">  
                                <h:outputText value="#{row.viewCounter}" />
                            </p:column>

                        </p:dataTable>


                        <c:if test="#{clientMainPageMB.awaitingSelectedCase!=null}" var="costam">
                            <h:commandLink class="topMenuButton  redX wideButton" value="Wycofaj" action="#{ clientMainPageMB.backOffAwaiting() }"/>
                        </c:if>
                        <p:commandButton disabled="#{empty clientMainPageMB.awaitingSelectedCase}" ajax="false" styleClass="topMenuButton greyButton wideButton" value="Szczegóły" action="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.awaitingSelectedCase)}" />
                     
                    </h:form>   

                </div>

                <div class="marginT50">

                    <h:form id="currentForm">

                        <h4> TRWAJĄCE </h4>               

                        <p:dataTable id="currentCases" value="#{clientMainPageMB.currentClientCaseList}" rowKey="#{row.idClientCase}"  var="row" emptyMessage="Nie ma żadnych spraw" selection="#{clientMainPageMB.currentSelectedCase}" selectionMode="single" >

                            <p:ajax event="rowSelect" update="@form" /> 
                            <p:ajax event="rowDblselect"  listener="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.currentSelectedCase)}"/>


                            <p:column headerText="Data dodania">    
                                <h:outputText  value="#{row.beginDate}">
                                    <f:convertDateTime pattern="dd-MM-yy" timeZone="GMT+3"/>
                                </h:outputText>  
                            </p:column>  

                            <p:column headerText="Numer sprawy">  
                                <h:outputText  value="#{row.idClientCase}"/>
                            </p:column>  

                            <p:column headerText="Postęp">  
                                <h:outputText  value="#{row.phase}"/>
                            </p:column> 

                            <p:column headerText="Rodzaj kredytu"  >
                                <h:outputText  value="#{row.productType.name}"/>
                            </p:column> 

                            <p:column headerText="BIK">
                                <h:outputText  value="#{clientMainPageMB.showBIK(row.client) ? 'TAK' : 'NIE' }"/>                         
                            </p:column> 

                            <p:column headerText="Kod pocztowy">  
                                <h:outputText  value="#{row.client.addresses.toArray()[0].zipCode}"/>
                            </p:column>

                            <p:column headerText="Wiek">  
                                <h:outputText  value="#{clientMainPageMB.converters.ageFromBirthDate(row.client.birthDate)}"/>
                            </p:column>

                            <p:column headerText="Typ zatrudnienia">
                                <h:outputText rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() == 1}" value="#{clientMainPageMB.modelsEmploymentType.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsEmploymentType.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Branża"> 
                                <h:outputText rendered="#{clientMainPageMB.modelsBranch.get(0).size() == 1}" value="#{clientMainPageMB.modelsBranch.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsBranch.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsBranch.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Trudność kredytu"> 
                                <h:outputText  value="#{row.difficulty}"/>
                            </p:column>

                            <p:column headerText="Status"> 
                                <h:outputText value="#{row.caseStatus.name}" />
                            </p:column>                     
                        </p:dataTable>

                        <c:if test="#{clientMainPageMB.currentSelectedCase!=null}" var="costam">
                            <h:link class="topMenuButton greyButton wideButton" value="Kontakt z doradcą" outcome="/client/clientMainPage"/>
                            <h:commandLink class="topMenuButton  redX wideButton" value="Wycofaj" action="#{ clientMainPageMB.backOffCurrent() }"/>
                        </c:if>
                        <p:commandButton disabled="#{empty clientMainPageMB.currentSelectedCase}" ajax="false" styleClass="topMenuButton greyButton wideButton" value="Szczegóły" action="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.currentSelectedCase)}" />
                     
                    </h:form>

                </div>



                <div class="marginT50">

                    <h:form id="finishedForm">  

                        <h4>MOJE ZAKOŃCZONE SPRAWY</h4>

                        <p:dataTable id="finishedCases" value="#{clientMainPageMB.finishedClientCaseList}" rowKey="#{row.idClientCase}"  var="row" emptyMessage="Nie ma żadnych spraw" selection="#{clientMainPageMB.finishedSelectedCase}" selectionMode="single" >

                            <p:ajax event="rowSelect" update="@form"/> 
                            <p:ajax event="rowDblselect"  listener="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.finishedSelectedCase)}"/>
                            
                            <p:column headerText="Data dodania">    
                                <h:outputText  value="#{row.beginDate}">
                                    <f:convertDateTime pattern="dd-MM-yy" timeZone="GMT+3"/>
                                </h:outputText>  
                            </p:column>  

                            <p:column headerText="Numer sprawy">  
                                <h:outputText  value="#{row.idClientCase}"/>
                            </p:column>  

                            <p:column headerText="Postęp">  
                                <h:outputText  value="#{row.phase}"/>
                            </p:column> 

                            <p:column headerText="Rodzaj kredytu"  >
                                <h:outputText  value="#{row.productType.name}"/>
                            </p:column> 

                            <p:column headerText="BIK">
                                <h:outputText  value="#{clientMainPageMB.showBIK(row.client) ? 'TAK' : 'NIE' }"/>                         
                            </p:column> 

                            <p:column headerText="Kod pocztowy">  
                                <h:outputText  value="#{row.client.addresses.toArray()[0].zipCode}"/>
                            </p:column>

                            <p:column headerText="Wiek">  
                                <h:outputText  value="#{clientMainPageMB.converters.ageFromBirthDate(row.client.birthDate)}"/>
                            </p:column>

                            <p:column headerText="Typ zatrudnienia">
                                <h:outputText rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() == 1}" value="#{clientMainPageMB.modelsEmploymentType.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsEmploymentType.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Branża"> 
                                <h:outputText rendered="#{clientMainPageMB.modelsBranch.get(0).size() == 1}" value="#{clientMainPageMB.modelsBranch.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsBranch.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsBranch.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Trudność kredytu"> 
                                <h:outputText  value="#{row.difficulty}"/>
                            </p:column>

                            <p:column headerText="Data zakończenia">  
                                <h:outputText value="01-01-2014" />
                            </p:column>

                            <p:column headerText="Umowa"> 
                                <h:outputText value="Tak" />
                            </p:column>   

                            <p:column headerText="Kwota">  
                                <h:outputText style="color: green;" value="#{row.consolidationValue}" />
                            </p:column> 

                            <p:column  headerText="Ocena doradcy">  
                                <h:outputText style="color: red;" value="4.9" />
                            </p:column> 

                            <p:column headerText="Status">  
                                <h:outputText value="#{row.caseStatus.name}" />
                            </p:column> 

                        </p:dataTable>

                        <c:if test="#{clientMainPageMB.finishedSelectedCase!=null}" var="costam">
                            <h:link class="topMenuButton greyButton wideButton" value="Generuj raport" outcome="/index"/>
                        </c:if>
                        <p:commandButton disabled="#{empty clientMainPageMB.finishedSelectedCase}" ajax="false" styleClass="topMenuButton greyButton wideButton" value="Szczegóły" action="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.finishedSelectedCase)}" />
                     


                    </h:form>  

                </div>

                <div>

                    <h:form id="premiumForm">

                        <h4> PREMIUM </h4>

                        <p:dataTable id="premiumCases" value="#{clientMainPageMB.premiumClientCaseList}" rowKey="#{row.idClientCase}"  var="row" emptyMessage="Nie ma żadnych spraw" selection="#{clientMainPageMB.premiumSelectedCase}" selectionMode="single" >

                            <p:ajax event="rowSelect" update="@form"/> 
                            <p:ajax event="rowDblselect"  listener="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.premiumSelectedCase)}"/>
                                                        
                            <p:column headerText="Data dodania">    
                                <h:outputText  value="#{row.beginDate}">
                                    <f:convertDateTime pattern="dd-MM-yy" timeZone="GMT+3"/>
                                </h:outputText>  
                            </p:column>  

                            <p:column headerText="Numer sprawy">  
                                <h:outputText  value="#{row.idClientCase}"/>
                            </p:column>  

                            <p:column headerText="Postęp">  
                                <h:outputText  value="#{row.phase}"/>
                            </p:column> 

                            <p:column headerText="Rodzaj kredytu"  >
                                <h:outputText  value="#{row.productType.name}"/>
                            </p:column> 

                            <p:column headerText="BIK">
                                <h:outputText  value="#{clientMainPageMB.showBIK(row.client) ? 'TAK' : 'NIE' }"/>                         
                            </p:column> 

                            <p:column headerText="Kod pocztowy">  
                                <h:outputText  value="#{row.client.addresses.toArray()[0].zipCode}"/>
                            </p:column>

                            <p:column headerText="Wiek">  
                                <h:outputText  value="#{clientMainPageMB.converters.ageFromBirthDate(row.client.birthDate)}"/>
                            </p:column>

                            <p:column headerText="Typ zatrudnienia">
                                <h:outputText rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() == 1}" value="#{clientMainPageMB.modelsEmploymentType.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsEmploymentType.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsEmploymentType.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Branża"> 
                                <h:outputText rendered="#{clientMainPageMB.modelsBranch.get(0).size() == 1}" value="#{clientMainPageMB.modelsBranch.get(0).toArray()[0]}"/>
                                <h:selectOneMenu rendered="#{clientMainPageMB.modelsBranch.get(0).size() > 1}" value=" ">
                                    <f:selectItems value="#{clientMainPageMB.modelsBranch.get(0)}" />
                                </h:selectOneMenu>
                            </p:column>

                            <p:column headerText="Trudność kredytu"> 
                                <h:outputText  value="#{row.difficulty}"/>
                            </p:column>

                            <p:column headerText="Ilość doradców"> 
                                <h:outputText value="#{clientMainPageMB.countConsultantApplications(row)}" />
                            </p:column>

                            <p:column headerText="Koniec aukcji"> 
                                <h:outputText  value="#{clientMainPageMB.converters.hoursLeft(row.endDate)}"/>        
                            </p:column> 

                            <p:column headerText="Ilość wyświetleń">  
                                <h:outputText value="7" />
                            </p:column>      

                            <p:column style="background:  #5297cb" headerText="Wybierz/zmień doradcę">  

                                <h:outputText value=" " />

                            </p:column>      


                        </p:dataTable>
                        <p:commandButton disabled="#{empty clientMainPageMB.premiumSelectedCase}" ajax="false" styleClass="topMenuButton greyButton wideButton" value="Szczegóły" action="#{clientMainPageMB.rowDoubleClick(clientMainPageMB.premiumSelectedCase)}" />
                     
                    </h:form>

                </div>


            </ui:define>           
        </ui:composition>
    </body>
</html>
