<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">



    <body>

        <ui:composition template="/templates/mainTemplate.xhtml">
            <ui:define name="title"> Klient - nowy wniosek </ui:define> 
            <ui:define name="top"> 
                <h:outputStylesheet library="css" name="green.css" />

                <div class="topbarLogo">
                    <h:graphicImage id="sf_logo" alt="could not be found."  value="/resources/images/spolecznosc_logo2.png" title="SF Logo" ></h:graphicImage>
                    <h:link outcome="/client/clientMainPage"> <h:graphicImage class="bigMenuButton" id="green_home_icon" alt="could not be found."  value="/resources/images/home_green.png" title="Home" ></h:graphicImage> </h:link>
                    <h:link outcome="/client/clientSettings"> <h:graphicImage class="bigMenuButton" id="profile_icon" alt="could not be found."  value="/resources/images/profile_logo_black.png" title="Profile" ></h:graphicImage> </h:link>
                </div>

                <div class="topbarMenuGreen">
                    <h:panelGroup>
                        <h:link class="topMenuButton greyButton wideButton" value="Wyloguj" outcome="/login"/>
                        <h:link class="topMenuButton greyButton wideButton" value="Edytuj dane" outcome="/client/clientSettings"/>
                        <h:link class="topMenuButton greyButton wideButton" value="Usuń konto" outcome="/client/clientDeleteAccount"/>
                        <h:link class="topMenuButton greyButton wideButton" value="Doładuj konto" />
                        <h:link class="topMenuButton greyButton wideButton" value="Zgłoś naruszenie zasad" outcome="/policy_violation"/>
                    </h:panelGroup>
                </div>
            </ui:define>

            <ui:define name="content">



                <div id="profileBar" class="profilBar">
                    <h:graphicImage class="profilLogo" id="profil_logo_green" alt="could not be found."  value="/resources/images/profil_green.png" title="Profile Green" ></h:graphicImage>

                    <div id="spaceFiller" > </div>
                    <div>     
                        <h5> #{loginMB.client.name} #{loginMB.client.lastName} </h5> 
                        <h:outputText class="profileText" value="nr. klienta:" />
                        <h5> #{loginMB.client.user.login} </h5>
                        <h:outputText class="profileText" value="Stan konta:" />
                        <h5> #{loginMB.client.points} / 5 </h5>
                    </div>
                </div>


                <div>

                    <div class="contentBox" style="margin-bottom: 30px;">

                        <div class="leftBox">

                            <h3 class="greenLeftBorder"> Nowy wniosek </h3>
                            <h:form>  
                                <h:panelGroup>
                                    <div class="field"> <h:outputText class="label" value="Data Rozpoczęcia:"/>  
                                        <p:calendar   mindate="#{clientCaseMB.currentDate}" required="true" id="begin-date"  yearRange="2005:2015" navigator="true"   value="#{clientCaseMB.clientCase.beginDate}">
                                            <p:ajax  event="dateSelect" update="end-date"  />
                                        </p:calendar>
                                        <h:message for="consolidationValue" errorClass="invalid" id="beginDate" />
                                    </div>

                                    <div class="field"> <h:outputText class="label" value="Data zakończenia"/>  
                                        <p:calendar mindate="#{clientCaseMB.clientCase.beginDate}" required="true" id="end-date" yearRange="2005:2015" navigator="true"   value="#{clientCaseMB.clientCase.endDate}">
                                            <p:ajax  event="dateSelect" update="begin-date"  />
                                        </p:calendar>
                                    </div>

                                    <div class="field"> 
                                        <h:outputText class="label" value="Kwota konsolidacji:"/>  
                                        <h:inputText maxlength="13"  required="true" id="consolidationValue" value="#{clientCaseMB.clientCase.consolidationValue}"  > 
                                            <f:converter converterId="javax.faces.BigDecimal"   />
                                            <f:validateDoubleRange minimum="0.01" maximum="9999999999.99"  />
                                            <p:ajax  event="keyup" update="consolidationValueMessage" />
                                        </h:inputText>
                                        <h:message for="consolidationValue" errorClass="invalid" id="consolidationValueMessage" />
                                    </div>

                                    <div class="field"> 
                                        <h:outputText class="label" value="Kwota wolne środki:"/>  
                                        <h:inputText maxlength="13" id="freeResourcesValue" value="#{clientCaseMB.clientCase.freeResourcesValue}" > 
                                            <f:converter converterId="javax.faces.BigDecimal"   />
                                            <f:validateDoubleRange minimum="0.00" maximum="9999999999.99"  />
                                            <p:ajax  event="keyup" update="freeResourcesValueMessage" />
                                        </h:inputText>
                                        <h:message for="freeResourcesValue" errorClass="invalid" id="freeResourcesValueMessage" />
                                    </div>

                                    <div class="field"> 
                                        <h:outputText class="label" value="Oczekiwana rata:"/>
                                        <h:inputText maxlength="9" id="expectedInstalment" required="true" value="#{clientCaseMB.clientCase.expectedInstalment}"> 
                                            <f:converter converterId="javax.faces.BigDecimal"    />
                                            <f:validateDoubleRange minimum="0.01" maximum="999999.99"  />
                                            <p:ajax  event="keyup" update="expectedInstalmentMessage" />
                                        </h:inputText>
                                        <h:message for="expectedInstalment" errorClass="invalid" id="expectedInstalmentMessage" />
                                    </div>


                                    <div class="field"> 
                                        <h:outputText class="label" value="Cel:"/>
                                        <h:inputText id="goal" maxlength="255" required="true" value="#{clientCaseMB.clientCase.goal}">
                                            <f:validateLength maximum="255"/>
                                            <p:ajax event="keyup" update="goalMessage" />
                                        </h:inputText>
                                        <h:message for="goal" errorClass="invalid" id="goalMessage" />
                                    </div>

                                    <div class="field"> 
                                        <h:outputText class="label" value="notatka"/>
                                        <h:inputTextarea cols="29" rows="10" value="#{clientCaseMB.clientCase.note}" >
                                            <f:validateLength maximum="100"/>
                                        </h:inputTextarea>    
                                    </div>

                                    <div class="field"> <h:outputText class="label" value="Rodzaj produktu"/> 
                                        <p:selectOneMenu value="#{clientCaseMB.idTypProduktu}">
                                            <f:selectItems value="#{dictionaryMB.productType}" var="w" itemLabel="#{w.name}" itemValue="#{w.idProductType}"/>
                                        </p:selectOneMenu>
                                    </div>

                                    <div class="field"> 
                                        <h:outputText class="label" value="Premium"/> 
                                        <p:selectBooleanCheckbox disabled="#{clientCaseMB.premiumPointsChecking()}" value="#{clientCaseMB.clientCase.premium}" >
                                            <p:ajax update="msg"  listener="#{clientCaseMB.addMessage()}" /> 
                                        </p:selectBooleanCheckbox>
                                        <p:growl id="msg" severity="info, warn"  />
                                    </div>


                                    <p:dialog id="basicDialog2" header="Premium" widgetVar="dlg2" rendered="true">
                                        Sprawa premium zabierze Ci 30 szalonych punktów!
                                        <h:commandButton type="reset" value="OK" onclick="dlg2.hide();"/>
                                    </p:dialog>


                                </h:panelGroup>


                                <h:commandButton  rendered="#{loginMB.activeAddingApp}" value="Dodaj do giełdy" action="#{clientCaseMB.addCase()}" />


                                <p:dialog id="basicDialog" header="Doładuj konto." widgetVar="dlg1" rendered="true">  
                                    <h:panelGrid columns="1">
                                        <h:outputText value="Niestety wyczerpałeś już swój limit punktów na dodawanie wniosków. Doładuj punkty i wypełnij wniosek ponownie." />  
                                        <h:commandButton type="reset" value="OK" onclick="dlg1.hide();"/>
                                    </h:panelGrid>
                                </p:dialog>  

                                <h:commandButton action="false" rendered="#{!loginMB.activeAddingApp}" value="Dodaj do giełdy" onclick="dlg1.show();" />




                            </h:form>        

                        </div>   


                        <div class="rightBox" style="width: 50%;">

                            <h4 class="greenLeftBorder"> Koszt punktów: </h4>

                            <h4 class="greenLeftBorder"> PUNKTY - Jak działa i co za ile </h4>
                            <div>

                                Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Typi non habent claritatem insitam; est usus legentis in iis qui facit eorum claritatem. Investigationes demonstraverunt lectores legere me lius quod ii legunt saepius. Claritas est etiam processus dynamicus, qui sequitur mutationem consuetudium lectorum. Mirum est notare quam littera gothica, quam nunc putamus parum claram, anteposuerit litterarum formas humanitatis per seacula quarta decima et quinta decima. Eodem modo typi, qui nunc nobis videntur parum clari, fiant sollemnes in futurum.

                            </div>

                            <h4 class="greenLeftBorder"> DODAWANIE RAPORTU BIKu </h4>
                            <div style="margin-bottom: 30px;">

                                Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat, vel illum dolore eu feugiat nulla facilisis at vero eros et accumsan et iusto odio dignissim qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi.

                            </div>
                            <h:form>
                                <div class="field">  <h:selectBooleanCheckbox/>  <h:outputText value="Posiadam raport BIK"/> </div>
                                <div class="field">  <h:selectBooleanCheckbox/>  <h:outputText value="Nie posiadam raportu BIK"/> </div>
                            </h:form>
                            <div id="buttonsBox1" style="margin-top: 30px;">

                                <h:link class="greyButton wideButton" value="Więcej o usłudze" style="margin-right: 20px; width: 190px;"/>

                                <h:link class="greyButton wideButton" value="Wykup usługe skanowania BIKu" style="width: 190px;"/>

                            </div>

                            <h4 class="greenLeftBorder"> OBECNE ZOBOWIĄZANIA </h4>

                            <h:form id="obligationForm">
                                <p:dataTable value="#{clientCaseMB.retrieveObligationListForCurrentClient()}" id="obligationTable" var="row" rowKey="#{row.idObligation}"
                                             selection="#{clientCaseMB.selectedObligation}" selectionMode="single">

                                    <p:column headerText="Lp">  
                                        #{wiersz+1}
                                    </p:column>  

                                    <p:column headerText="Rodzaj">  
                                        #{row.obligationKind}
                                    </p:column>  

                                    <p:column headerText="Wygasa">    
                                        #{row.beginDate}
                                    </p:column>  

                                    <p:column headerText="Rata"> 
                                        #{row.actualPrice}
                                    </p:column>  

                                    <p:column headerText="Kwota">  
                                        #{row.repayment}
                                    </p:column> 

                                    <p:column headerText="Zaległe"  >  

                                        <h:selectBooleanCheckbox value="#{row.active}" disabled="true" />

                                    </p:column> 

                                </p:dataTable>
                                <h:panelGrid columns="2" >
                                    <p:commandButton style="margin:0 30px;" value="Dodaj zobowiązanie" onclick="zobDial2.show();"  /> 
                                    <p:commandButton style="margin:0 30px;" value="Usuń" update="@form" action="#{clientCaseMB.delObligation}" />
                                </h:panelGrid>
                                
                            </h:form>
                            <div id="buttonsBox2" style="margin-top: 30px; height: 50px;">



                                <p:dialog width="350" hideEffect="explode"  draggable="false" showEffect="clip" id="zobDial" header="Dodaj zobowiązanie" widgetVar="zobDial2" rendered="true">  
                                    <h:form id="costam23">
                                        <h:panelGrid  class="obligationDialogBox" columns="2" cellspacing="5" >

                                            <h:outputText value="Rodzaj zobowiązania"/>
                                            <h:selectOneMenu value="#{clientCaseMB.obligation.obligationKind}">
                                                <f:selectItem itemLabel="Bankowe" itemValue="b"/>
                                                <f:selectItem itemLabel="Pozabakowe" itemValue="p"/>
                                            </h:selectOneMenu>

                                            <h:outputText value="Wygasa:"/>
                                            <p:calendar effect="slide" value="#{clientCaseMB.obligation.beginDate}"/>

                                            <h:outputText value="Rata:"/>
                                            <h:inputText required="true" id="actualPrice" value="#{clientCaseMB.obligation.actualPrice}">
                                                <f:converter converterId="javax.faces.BigDecimal"    />
                                                <f:validateDoubleRange minimum="0.00" maximum="999999.99"  />
                                                <p:ajax event="keyup" update="actualPriceMessage" />
                                            </h:inputText>    

                                            <h:outputText />
                                            <h:message errorClass="invalid"  for="actualPrice" id="actualPriceMessage" />

                                            <h:outputText value="Kwota:"/>
                                            <h:inputText required="true" id="repayment" value="#{clientCaseMB.obligation.repayment}">
                                                <f:converter converterId="javax.faces.BigDecimal"    />
                                                <f:validateDoubleRange minimum="0.00" maximum="999999.99"  />
                                                <p:ajax event="keyup" update="repaymentMessage" />
                                            </h:inputText>
                                            <h:outputText />
                                            <h:message errorClass="invalid"  for="repayment" id="repaymentMessage" />


                                            <h:outputText value="Tytulem"/>
                                            <h:inputText value="#{clientCaseMB.obligation.name}"/>

                                            <h:outputText value="Aktualne"/>
                                            <h:selectBooleanCheckbox value="#{clientCaseMB.obligation.active}"/>

                                            <h:outputText value="Rodzaj produktu"/> 
                                            <h:selectOneMenu value="#{clientCaseMB.idTypProduktuObligation}">
                                                <f:selectItems value="#{dictionaryMB.productType}" var="w" itemLabel="#{w.name}" itemValue="#{w.idProductType}"/>
                                            </h:selectOneMenu>
                                            <p:commandButton style="float:right;" value="Anuluj" type="reset" onclick="zobDial2.hide();"/>
                                            <p:commandButton update=":obligationForm:obligationTable costam23 " oncomplete="if (!args.validationFailed){ zobDial2.hide(); }" style="float:right;" value="Dodaj" action="#{clientCaseMB.addObligation()}" />


                                        </h:panelGrid>


                                    </h:form>  
                                </p:dialog>

                            </div>
                            <div id="buttonsBox3">

                                <h:link class="greenButton wideButton" value="Dalej" style="float: right;" outcome="/client/clientMainPage"/>

                            </div>

                        </div>

                    </div>

                    <div class="greenLine" ></div>  


                    <h4 class="greenLeftBorder"> PODGLĄD GIEŁDY</h4>

                    <p:dataTable > 

                        <p:column headerText="Lp" >  

                        </p:column> 

                        <p:column headerText="Numer klienta">  
                        </p:column>  

                        <p:column headerText="Data dodania">    
                        </p:column>  

                        <p:column headerText="Numer sprawy">  
                        </p:column>  

                        <p:column headerText="Postęp">  
                        </p:column> 

                        <p:column headerText="Rodzaj kredytu"  >  
                        </p:column> 

                        <p:column headerText="BIK">  
                        </p:column> 

                        <p:column headerText="Kod pocztowy">  
                        </p:column>

                        <p:column headerText="Wiek">  
                        </p:column>

                        <p:column headerText="Typ zatrudnienia">  
                        </p:column>

                        <p:column headerText="Branża">  
                        </p:column>

                        <p:column headerText="Trudności kredytu">  
                        </p:column>

                        <p:column headerText="Ilość doradców">  
                        </p:column>                  

                        <p:column headerText="Koniec aukcji">  
                        </p:column>      


                    </p:dataTable>
                </div>

                <div style="min-height: 30px;">

                </div>


            </ui:define>           
        </ui:composition>
    </body>
</html>
