<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/templates/template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core" >

    

    <ui:define name="maincenter">

     <c:if test="#{logowanieMB.zalogowany==true}" var="x">
        
        <h:panelGroup style=" font-weight: bold; font-size: larger; display: block" styleClass="borderbeauhead vmargin bodyheadtop">Kredyty danego Klienta:</h:panelGroup>    
        <h:panelGroup style="display: block" styleClass="bodyheadbuttom"></h:panelGroup> 
         
        <h:panelGroup style=" display: block" styleClass="borderbeau vmargintable">

            <p:scrollPanel>

               <h:form prependId="false">

                    <p:dataTable  id="dataTable1" value="#{kredytyMB.kredytylist}" var="data2" paginator="true" rows="20" 
                                  rowKey="#{data2.kredytyId}"  selection="#{kredytyMB.selectedKredyt}" selectionMode="single"
                                  paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="20,60,100">                

                        <p:ajax event="rowSelect" update="dataTable1"/>
                        <p:ajax event="rowUnselect" update="dataTable1"/>

                        <p:column width="120"><f:facet name="header">Nazwa Banku</f:facet>#{data2.nazwaBanku}</p:column>
                        <p:column filterBy="#{data2.nrUmowyPosrednictwa}"><f:facet name="header">Nr Umowy Posrednictwa</f:facet>#{data2.nrUmowyPosrednictwa}</p:column>
                        <p:column width="30"><f:facet name="header">Kwota Kredytu Brutto</f:facet>#{data2.kwotaKredytuBrutto}</p:column>
                        <p:column width="30"><f:facet name="header">Prowizja Banku w %</f:facet>#{data2.prowizjaBankuWprocentach}</p:column>
                        <p:column width="30"><f:facet name="header">prowizja Banku w PLN</f:facet>#{data2.prowizjaBankuWpln}</p:column>
                        <p:column width="30"><f:facet name="header">Ubezp. w PLN</f:facet>#{data2.ubezpieczenieWpln}</p:column>
                        <p:column width="30"><f:facet name="header">Kaszta w PLN</f:facet>#{data2.kosztaWpln}</p:column>
                        <p:column width="30"><f:facet name="header">Swot w %</f:facet>#{data2.swotWprocentach}</p:column>
                        <p:column width="30"><f:facet name="header">Swot w PLN</f:facet>#{data2.swotWpln}</p:column>
                        <p:column width="30"><f:facet name="header">Kwota Konsolidacji</f:facet>#{data2.kwotaKonsolidacji}</p:column>
                        <p:column width="30"><f:facet name="header">Okres Kredyt. w Mc</f:facet>#{data2.okresKredytowaniaWmc}</p:column>
                        <p:column width="30"><f:facet name="header">Rata w PLN</f:facet>#{data2.rataWpln}</p:column>
                        <p:column width="30"><f:facet name="header">%</f:facet>#{data2.oprocentowanieWprocentach}</p:column>
                        <p:column width="30"><f:facet name="header">Wolna Gotowka</f:facet>#{data2.wolnaGotowka}</p:column>
                        <p:column><f:facet name="header">Miejsce Podpisania Dokumentow</f:facet>#{data2.miejscePodpisaniaDokumentow}</p:column>
                        <p:column width="85"><f:facet name="header">Data Mozliwego Uruchomentow</f:facet>#{data2.dataMozliwegoUruchomienia}</p:column>  
                        <p:column width="10" style="text-align: center; white-space: nowrap; padding: 5px 5px" ><f:facet name="header">Generuj</f:facet>
                            <h:commandLink action="#{kredytyMB.callPdf(data2.kredytyId)}">                                  
                                <p:graphicImage height="32" value="/resources/photo/generate.gif" />                                   
                            </h:commandLink>    
                        </p:column> 
                        
                        <p:column width="10" style="text-align: center; white-space: nowrap; padding: 5px 5px" > <f:facet name="header">Podgląd</f:facet> 
                            <h:commandLink target="_blank"  action="#{kredytyMB.downLoad(kredytyMB.klienci2.klienciId, data2.kredytyId)}" rendered="#{data2.czyWygenerowanoDokumenty}">
                                <p:graphicImage height="32" value="/resources/photo/pdf.png" />        
                            </h:commandLink>
                        </p:column> 

                        <f:facet name="footer"> 
                            <c:if test="#{kredytyMB.selectedKredyt!=null}" var="costam">
                                <h:commandButton id="viewButton" value="edytuj" action="#{kredytyMB.selectedClientRedirect()}" />
                                <h:commandButton id="modalDialogButton" value="usuń" onclick="dlg2.show();" type="button"/>
                            </c:if>
                        </f:facet>  

                    </p:dataTable>  

                    <p:dialog id="modalDialog" header="usuń kredyt" widgetVar="dlg2" modal="true" height="50" resizable="false">  
                        <h:outputText value="Czy napewno chcesz usunąć kredyt?" />  
                        <div style="text-align: center;"> 
                            <h:commandButton id="viewButton2" value="usuń" action="#{ kredytyMB.deleteKredyt() }" />
                        <h:button onclick="dlg2.hide();" value="anuluj"/>
                        </div>
                    </p:dialog>  
                    
                </h:form> 

            </p:scrollPanel>

        </h:panelGroup>       
        <h:form styleClass="bodyheadtop bodyheadbuttom">
            <h:panelGroup styleClass="cent "><h:commandButton value="dodaj nowy kredyt" action="#{ kredytyMB.newKredyt() }"/></h:panelGroup>            
        </h:form> 

        <c:if test="${kredytyMB.showDialog == true}">

            <c:if test="${kredytyMB.pdfSuccess == true}">    
                <script type="text/javascript" >
                    if(window.window){
                        alert(' Dokumenty wygenerowano pomyslnie! ');                     
                    }
                </script>  
            </c:if>

            <c:if test="${kredytyMB.pdfSuccess == false}">    
                <script type="text/javascript">
                    if(window.window){ 
                        alert(' Dokumenty nie zostaly wygenerowane! ');    
                    }
                </script> 
            </c:if>   

            <c:set var="kredytyMB.showDialog" scope="session" value="${false}" />

        </c:if> 

        
          
      </c:if>        
              
    </ui:define>



</ui:composition>
