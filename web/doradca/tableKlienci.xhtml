<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="./../templates/template.xhtml" 
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core" 
                xmlns="http://www.w3.org/1999/xhtml">



    <ui:define name="maincenter" >  

        <c:if test="#{logowanieMB.zalogowany==true}" var="x">

            <h:panelGroup style=" font-weight: bold; font-size: larger; display: block" styleClass="borderbeauhead vmargin bodyheadtop">Wyświetl Klientów</h:panelGroup>    
            <h:panelGroup style="display: block" styleClass="bodyheadbuttom"></h:panelGroup>     

            <h:panelGroup style=" display: block" styleClass="vmargintable">   
                <p:scrollPanel>
                    <h:form prependId="false">
                        <p:dataTable  id="dataTable1" value="#{klienciMB.klientList}" var="data" paginator="true" rows="20"  emptyMessage="brak klientĂłw!" 
                                      rowKey="#{data.klienciId}"  selection="#{klienciMB.selectedClient}" selectionMode="single" 
                                      paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" rowsPerPageTemplate="20,60,100">   

                            <p:ajax event="rowSelect" update="dataTable1"/>
                            <p:ajax event="rowUnselect" update="dataTable1"/>

                            <p:column filterBy="#{data.imie}" width="110"><f:facet name="header">Imie</f:facet>#{data.imie} </p:column>
                            <p:column filterBy="#{data.nazwisko}" width="110"><f:facet name="header">Nazwisko</f:facet>#{data.nazwisko} </p:column>
                            <p:column filterBy="#{data.pesel}" width="90"><f:facet name="header">Pesel</f:facet> #{data.pesel}</p:column>
                            <p:column width="30"><f:facet name="header">Seria Dowodu</f:facet>#{data.seriaDowodu} </p:column>
                            <p:column width="30"><f:facet name="header">Nr Dowodu</f:facet>#{data.nrDowodu} </p:column>
                            <p:column><f:facet name="header">Miejscowosc</f:facet>#{data.miejscowosc} </p:column>
                            <p:column style="width: 50px;"><f:facet name="header" >Kod pocztowy</f:facet>#{data.kodPocztowy} </p:column>
                            <p:column><f:facet name="header">Ulica</f:facet>#{data.ulica} </p:column>
                            <p:column style="width: 50px;"><f:facet name="header">Nr Domu</f:facet>#{data.nrDomu} </p:column>
                            <p:column style="width: 50px;"><f:facet name="header">Nr Mieszkania</f:facet>#{data.nrMieszkania} </p:column>
                            <p:column><f:facet name="header">Poczta</f:facet>#{data.poczta }</p:column>
                            <c:if test="#{kredytyMB.czyKreatorAktywny==false}" var="costam">    
                                <p:column width="60"><f:facet name="header">Klient Kredyty </f:facet>
                                    <h:commandButton value="Kredyty" action="#{kredytyMB.callAllKredyty(data.klienciId)}" />
                                </p:column>
                            </c:if> 

                            <f:facet name="footer"> 

                                <h:commandButton value="nowy klient" style="float: left;" action="#{klienciMB.newClient()}" />

                                <c:if test="#{klienciMB.selectedClient!=null}" var="costam">

                                    <c:if test="#{kredytyMB.czyKreatorAktywny==false}" var="costam">

                                        <h:commandButton id="viewButton" value="edytuj" action="#{klienciMB.selectedClientRedirect()}" />
                                        <h:commandButton id="modalDialogButton" value="usuń" style="float: right;" onclick="dlg2.show();" type="button"/>

                                    </c:if>

                                    <c:if test="#{kredytyMB.czyKreatorAktywny==true}" var="costam">

                                            <h:commandButton id="viewButton3" value="wybierz" action="#{kredytyMB.addPartner(klienciMB.selectedClient) }" />
                                            <h:commandButton id="viewButton4" style="float: right;"  value="anuluj" action="#{kredytyMB.hidePartnerTable() }" />
                                       
                                    </c:if>

                                </c:if>

                                <c:if test="#{kredytyMB.czyKreatorAktywny==true}" var="costam">
                                    <p><h:outputText class="alert" value="kreator kredytu jest aktywny"/></p>
                                </c:if>

                            </f:facet>  

                        </p:dataTable>

                        <p:dialog id="modalDialog" header="usuń„ klienta" widgetVar="dlg2" modal="true" height="50" resizable="false">  
                            <h:outputText value="Czy napewno chcesz usunąć klienta?" />  
                            <div style="text-align: center;"> 

                                <h:commandButton id="viewButton2" value="usuń„" onclick="dlg2.hide();" >    
                                    <f:ajax listener="#{klienciMB.deleteClient()}" render="dataTable1" />    
                                </h:commandButton>

                                <h:button onclick="dlg2.hide();" value="anuluj"/>



                            </div>
                        </p:dialog>  



                    </h:form>
                </p:scrollPanel>



            </h:panelGroup>                  



        </c:if>      

    </ui:define>



</ui:composition>
